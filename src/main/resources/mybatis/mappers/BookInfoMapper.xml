<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.tarena.book.mapper.BookInfoMapper">

    <resultMap type="Book" id="BookRM">
	    <id column="book_id" property="bookId" />
	    <result column="book_name" property="bookName"/>
	    <association property="bookInfo" javaType="BookInfo">
	    	<result column="author" property="author"/>
	    	<result column="imgurl" property="imgurl"/>
	    	<result column="category" property="category"/>
	    	<result column="pub_date" property="pubDate"/>
	    </association>
    </resultMap>
    
    <insert id="saveBookUpload" >
    insert into book_info (book_info_id,author,imgurl,pub_date,category,book_pub) 
    		values(#{bookInfoId},#{author},#{imgurl},#{pubDate},#{category},#{bookPub})
    </insert>
    <select id="tocart" resultMap="BookRM">
   		SELECT bo.book_id,bo.book_name,b.author,b.category,b.imgurl,b.pub_date FROM 
		book bo
			LEFT JOIN
		(SELECT b.book_info_id,b.author,b.category,b.imgurl,b.pub_date FROM book_info
		 b,user_book_borrower u WHERE u.user_id='1' AND u.book_id=b.book_info_id) b
			ON b.book_info_id = bo.book_id;
 
    </select>

</mapper>