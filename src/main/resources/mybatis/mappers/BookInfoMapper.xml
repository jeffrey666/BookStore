<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.tarena.book.mapper.BookInfoMapper">

    
    
    <insert id="saveBookUpload" >
    insert into book_info (book_info_id,author,imgurl,pub_date,category,book_pub) 
    		values(#{bookInfoId},#{author},#{imgurl},#{pubDate},#{category},#{bookPub})
    </insert>
    
    <resultMap type="Book" id="bookRM" autoMapping="true">
    <id column="book_id" property="bookId"/>
    <result column="book_name" property="bookName"/>
    <result column="state" property="state"/>
    <association property="bookInfo" javaType="BookInfo">
      <id column="book_info_id" property="bookInfoId"/>
      <result column="author" property="author"/>
      <result column="borrow_count" property="borrowCount"/>
      <result column="imgurl" property="imgurl"/>
    </association>
    </resultMap>
    <select id="findAllByCount" resultMap="bookRM">
    SELECT b.book_id,b.book_name,b.state,bi.author,bi.borrow_count,bi.imgurl FROM book b,book_info bi 
    WHERE b.book_id=bi.book_info_id ORDER BY bi.borrow_count DESC
    </select>

</mapper>