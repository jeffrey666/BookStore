<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.tarena.book.mapper.BackUserMapper">

	<sql id="findAllUser_sql">
		SELECT * FROM
		user
		LEFT JOIN
		user_info
		ON
		`user`.id = user_info.user_info_id
	</sql>

	<resultMap type="User" id="user_rm" autoMapping="true">
		<id column="id" property="id" />
		<association property="userInfo" javaType="UserInfo">
			<id column="user_info_id" property="userInfoId" />
			<result column="nickname" property="nickname" />
			<result column="email" property="email" />
			<result column="address" property="address" />
			<result column="card_no" property="cardNo" />
			<result column="score" property="score" />
			<result column="telephone" property="telephone" />
			<result column="gender" property="gender" />
			<result column="birthday" property="birthday" />
			<result column="user_level" property="userLevel" />
		</association>
	</resultMap>

    <!--后台:查找所有的用户-->
	<select id="findBackAllUser" resultMap="user_rm">
		<include refid="findAllUser_sql"></include>
	</select>
	
	<!--后台:修改用户的状态  -->
	  <update id="changeState">
       update user set state=#{state} where id in
       <foreach collection="ids" item="id" open="(" close=")" separator=",">
           #{id}
       </foreach>
      </update>
      
      <!--后台:删除用户  -->
       <delete id="deleteUser">
        delete from user where id in
        <foreach collection="array" item="id" open="(" close=")" separator=",">
           #{id}
       </foreach>
      </delete>
      
      <!--后台:删除用户详情  -->
      <delete id="deleteUserInfo">
        delete from user_info where user_info_id in
        <foreach collection="array" item="id" open="(" close=")" separator=",">
           #{id}
       </foreach>
      </delete>
	
	
	
	
	
	
</mapper>